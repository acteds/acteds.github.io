<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>ADB相关知识 &mdash; 个人博客</title><link rel="stylesheet" href="/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="/assets/css/components/collection.css"><link rel="stylesheet" href="/assets/css/components/repo-card.css"><link rel="stylesheet" href="/assets/css/sections/repo-list.css"><link rel="stylesheet" href="/assets/css/components/boxed-group.css"><link rel="stylesheet" href="/assets/css/globals/common.css"><link rel="stylesheet" href="/assets/css/globals/responsive.css"><link rel="stylesheet" href="/assets/css/posts/index.css"><link rel="stylesheet" href="/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="/assets/css/highlight/monokai.sublime.css"><link rel="canonical" href="/2024/10/31/ADB%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/"><link rel="alternate" type="application/atom+xml" title="个人博客" href="/feed.xml"><link rel="shortcut icon" href="/favicon.ico"><meta property="og:title" content="ADB相关知识"><meta name="keywords" content="Android"><meta name="og:keywords" content="Android"><meta name="description" content="引言ADB（Android Debug Bridge）是一个命令行工具，用于与 Android 设备进行交互和管理。它是 Android SDK 的一部分，主要用于开发和调试 Android 应用程序。"><meta name="og:description" content="引言ADB（Android Debug Bridge）是一个命令行工具，用于与 Android 设备进行交互和管理。它是 Android SDK 的一部分，主要用于开发和调试 Android 应用程序。"><meta property="og:url" content="/2024/10/31/ADB%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/"><meta property="og:site_name" content="个人博客"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2024-10-31"> <script src="/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="/assets/js/jquery-ui.js"></script> <script src="/assets/js/main.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80669434-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-80669434-1'); </script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="/" title="个人博客"><span class="octicon octicon-mark-github"></span> 个人博客</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="/" class=" site-header-nav-item" target="" title="首页">首页</a> <a href="/categories/" class=" site-header-nav-item" target="" title="分类">分类</a> <a href="/wiki/" class=" site-header-nav-item" target="" title="维基">维基</a> <a href="/about/" class=" site-header-nav-item" target="" title="关于">关于</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="ADB相关知识"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">ADB相关知识</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2024/10/31 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="/categories/#Android" title="Android">Android</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 1985 字，约 6 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><h1 id="引言">引言</h1><p>ADB（Android Debug Bridge）是一个命令行工具，用于与 Android 设备进行交互和管理。它是 Android SDK 的一部分，主要用于开发和调试 Android 应用程序。</p><h1 id="adb">ADB</h1><p>ADB 提供了一个通用的命令接口，可以通过 USB 或 Wi-Fi 连接 Android 设备，允许开发者执行多种操作，包括：</p><ol><li><strong>安装和卸载应用</strong>：可以通过命令行在设备上安装或卸载 APK 文件。</li><li><strong>设备管理</strong>：能够列出已连接的设备，检查设备状态，重启设备等。</li><li><strong>调试应用</strong>：开发者可以通过 ADB 向 Android 设备发送调试命令，查看日志（使用 <code class="language-plaintext highlighter-rouge">logcat</code>），捕获屏幕截图等。</li><li><strong>文件传输</strong>：可以通过 ADB 在电脑和 Android 设备之间传输文件。</li><li><strong>运行 shell 命令</strong>：可以直接在设备上执行 shell 命令，以进行更深入的管理。</li></ol><p>ADB 的基本使用示例：</p><p><strong>列出连接的设备</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb devices
</code></pre></div></div><p><strong>安装应用</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb <span class="nb">install </span>path/to/app.apk
</code></pre></div></div><p><strong>卸载应用</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb uninstall package.name
</code></pre></div></div><p><strong>查看设备日志</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb logcat
</code></pre></div></div><p><strong>进入设备的 shell</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb shell
</code></pre></div></div><p><strong>工作原理：</strong></p><p>ADB 通过 TCP/IP 协议与 Android 设备通信。它通常在本地机器和 Android 设备之间建立一个客户端-服务器架构，其中 ADB 服务器在主机上运行，而 ADB 客户端在命令行中运行，Android 设备则充当服务器端。</p><h2 id="adb服务器">ADB服务器</h2><p>ADB 服务器（ADB Server）是 Android Debug Bridge（ADB）中的一个关键组件，用于管理与 Android 设备之间的通信。它作为一个后台进程在主机上运行，负责协调 ADB 客户端和连接的 Android 设备。以下是 ADB 服务器的主要功能和特点：</p><ol><li><p><strong>设备管理</strong>：ADB 服务器维护已连接设备的状态信息，包括设备 ID、状态（如在线或离线）等。当通过 ADB 客户端发出命令时，ADB 服务器会判断当前连接的设备并执行相应操作。</p></li><li><p><strong>命令转发</strong>：当开发者在命令行中使用 ADB 命令时，这些命令首先被发送到 ADB 服务器。ADB 服务器会将这些命令转发到相应的 Android 设备，并将结果返回给客户端。</p></li><li><p><strong>多设备支持</strong>：<strong>ADB 服务器允许同时与多个 Android 设备进行通信</strong>。开发者可以通过不同的设备 ID 来区分不同的设备。</p></li><li><p><strong>简化连接</strong>：ADB 服务器管理与设备之间的 TCP/IP 连接，简化了开发者的连接流程。当开发者首次连接设备时，ADB 服务器会自动启动并进行设备发现。</p></li></ol><p><strong>工作原理</strong></p><ul><li><strong>启动过程</strong>：当运行任何 ADB 命令时，ADB 客户端会首先检查 ADB 服务器是否在运行。如果未运行，ADB 客户端会启动 ADB 服务器。</li><li><strong>端口</strong>：默认情况下，ADB 服务器在 5037 端口上监听请求。可以通过 <code class="language-plaintext highlighter-rouge">adb -P &lt;port&gt;</code> 命令指定其他端口。</li><li><strong>连接方式</strong>：ADB 可以通过 USB 连接设备，也可以通过 Wi-Fi 连接。当设备通过 USB 连接时，ADB 服务器会在设备上启用调试模式，以便进行操作。</li></ul><p><strong>常见命令</strong></p><p><strong>启动 ADB 服务器</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb start-server
</code></pre></div></div><p><strong>停止 ADB 服务器</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb kill-server
</code></pre></div></div><p><strong>查看已连接设备</strong>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb devices
</code></pre></div></div><p>ADB 服务器是开发和调试 Android 应用不可或缺的组件，它通过提供统一的接口简化了与设备的交互，帮助开发者高效地进行应用测试和管理。</p><p><strong>重要事项</strong></p><ol><li><strong>单一端口</strong>：同一时间内，ADB 服务器只能绑定到一个端口。如果尝试在<strong>同一端口</strong>上启动多个 ADB 实例，将导致冲突并出现错误。</li><li><strong>更改端口</strong>：如果你需要在多个实例之间切换，可以使用不同的端口。例如，你可以使用 <code class="language-plaintext highlighter-rouge">adb -L tcp:12345 fork-server server --reply-fd 688</code> 启动另一个 ADB 实例在端口 12345 上运行。</li><li><strong>服务器状态</strong>：如果需要重新启动 ADB 服务器，建议先停止现有的 ADB 实例，以避免端口占用冲突。可以使用 <code class="language-plaintext highlighter-rouge">adb kill-server</code> 命令来停止当前的 ADB 服务器。</li></ol><p><strong>一个安卓设备只能与一个 ADB 服务器建立连接。</strong>即使在不同的端口上启动多个 ADB 服务器，它们仍然无法同时连接到同一个设备。以下是一些相关细节：</p><p><strong>原因</strong></p><ol><li><strong>端口和通信</strong>：ADB 服务器通过 TCP/IP 协议与安卓设备通信，通常使用端口 5037。每个设备在同一时间只能被一个 ADB 服务器控制。</li><li><strong>设备状态</strong>：当一个 ADB 服务器连接到设备时，该设备的状态会被标记为 “device”。其他尝试连接的 ADB 服务器将收到设备 “offline” 或 “unauthorized” 的状态，因为设备已经与现有的 ADB 服务器建立了连接。</li></ol><p><strong>解决方案</strong></p><ul><li><strong>ADB 代理</strong>：如果需要在多个环境中使用 ADB，可以考虑使用 ADB 代理来转发命令，但这会增加复杂性。</li><li><strong>连接管理</strong>：确保在启动新的 ADB 服务器之前，先通过 <code class="language-plaintext highlighter-rouge">adb kill-server</code> 停止当前的 ADB 服务器连接，确保只有一个 ADB 实例在与设备通信。</li></ul><p>每次只允许一个 ADB 服务器与安卓设备建立连接，尝试同时连接多个 ADB 服务器将会导致连接冲突，无法正常工作。</p><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="" target="_blank">acteds</a></li><li>本文链接：<a href="/2024/10/31/ADB%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/" target="_blank">https://acteds.github.io/2024/10/31/ADB%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"> <script src="https://beaudar.lipk.org/client.js" repo="mzlogin/blog-comments" issue-term="title" label="gitment" theme="github-light" comment-order="desc" input-position="top" crossorigin="anonymous" async> </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: '/assets/search_data.json?v=1735912338', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2024 <span title="acteds">acteds</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/acteds/acteds.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="/" title="首页" target="">首页</a></li><li> <a href="/categories/" title="分类" target="">分类</a></li><li> <a href="/wiki/" title="维基" target="">维基</a></li><li> <a href="/about/" title="关于" target="">关于</a></li><li><a href="/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script></body></html>
